server:
  port: 8086

base-url:
  context: /axonect/aee/templates/v1.0/base-template
app:
  host: /MICROSERVICE_NAME/

log:
  identifierKey: UUID
  isDebug: true
info:
  app:
    name :  base-template
    msName : base-template
com:
  adl:
    dte:
      plugins:
        logging:
          enabled: true
          level: DEBUG
        rolling:
          policy: size
          size: 100000kb
        alarming:
          enabled: true
        msstat:
          enabled: true

logging:
  level:
    com.axonect: DEBUG

springdoc:
  packagesToScan: com.axonect.aee.template.baseapp.application.controller
  pathsToMatch: /**
  swagger-ui:
    configUrl: /MICROSERVICE_NAME/v3/api-docs/swagger-config
    url: /MICROSERVICE_NAME/v3/api-docs
    disable-swagger-default-url: true
  api-docs:
    path: /v3/api-docs

spring:
  # Redis Configuration
  data:
    redis:
      host: localhost
      port: 6379
      password:  # Set password if Redis requires authentication
      timeout: 5000ms
      jedis:
        pool:
          max-active: 50      # Maximum active connections in pool
          max-idle: 20        # Maximum idle connections in pool
          min-idle: 10        # Minimum idle connections in pool
          max-wait: 2000ms    # Maximum time to wait for connection from pool
  cache:
    type: redis
    redis:
      time-to-live: 3600000  # Default TTL: 1 hour (in milliseconds)
      cache-null-values: false  # Don't cache null values
      use-key-prefix: true      # Use cache name as key prefix
      key-prefix: "scheduling-service:"
  datasource:
#    url: jdbc:oracle:thin:@aaa-dev.cn8eyeqma3tp.ap-southeast-2.rds.amazonaws.com:1521/ORCL
    url: jdbc:oracle:thin:@localhost:1522/ORCL
    username: aaa
    password: Aaa!89nky78D
    driver-class-name: oracle.jdbc.OracleDriver
    hikari:
      # OPTIMIZED for 5M service_instance + 10M bucket_instance records
      minimum-idle: 10  # Keep at least 10 connections ready
      maximum-pool-size: 50  # Increased from 20 to handle high volume
      idle-timeout: 300000      # 5 minutes: close idle connections faster
      connection-timeout: 20000 # 20 seconds to get a connection
      max-lifetime: 1800000     # 30 minutes: max life of a connection
      validation-timeout: 3000  # 3 seconds to validate connection
      leak-detection-threshold: 60000  # 60 seconds: detect connection leaks
      initialization-fail-timeout: 0 # Prevent app from failing if DB not ready
      pool-name: OraclePool
      auto-commit: false  # Explicit transaction control for better performance
      # Oracle-specific optimizations
      data-source-properties:
        oracle.jdbc.implicitStatementCacheSize: 50  # Cache prepared statements
        oracle.net.CONNECT_TIMEOUT: 20000  # 20 seconds
        oracle.jdbc.ReadTimeout: 60000  # 60 seconds for large queries
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false  # Disable SQL logging in production for performance
    properties:
      hibernate:
        format_sql: false
        dialect: org.hibernate.dialect.OracleDialect
        # CRITICAL: Batch processing settings for massive scale (5M+ records)
        jdbc:
          batch_size: 100  # Process 100 inserts/updates in a single batch
          fetch_size: 100  # Fetch 100 rows at a time from result set
          batch_versioned_data: true  # Enable batch updates for versioned entities
        order_inserts: true  # Order inserts by entity type for better batching
        order_updates: true  # Order updates by entity type for better batching
        # Connection release optimization
        connection:
          provider_disables_autocommit: false  # Let Hibernate manage transactions
        # Query optimization
        query:
          in_clause_parameter_padding: true  # Optimize IN clause queries
          plan_cache_max_size: 2048  # Increase query plan cache
          plan_parameter_metadata_max_size: 256
        # Statement fetching optimization
        max_fetch_depth: 3  # Limit depth of outer joins
        default_batch_fetch_size: 16  # Batch fetch associated entities
        # Cache settings (minimal for high-volume batch processing)
        cache:
          use_second_level_cache: false  # Disable L2 cache for batch jobs
          use_query_cache: false  # Disable query cache for batch jobs
        # Statistics for monitoring (disable in production if not needed)
        generate_statistics: false  # Disable for better performance

recurrent-service.chunk-size: 100
delete-expired-buckets.chunk-size: 100

# Cache API Configuration
cache.api.connect-timeout: 5000         # Connection timeout in milliseconds
cache.api.read-timeout: 10              # Read timeout in seconds
cache.api.write-timeout: 10             # Write timeout in seconds
cache.api.response-timeout: 10          # Response timeout in seconds
cache.api.max-connections: 100          # Maximum connections in pool
cache.api.pending-acquire-timeout: 45   # Timeout for acquiring connection from pool (seconds)

########### Base Urls ###################
#ams.base-url: http://aeb53274042be477aba79f9076056316-ee9e05124271e8a5.elb.ap-southeast-2.amazonaws.com/airtel-aaa-accounting-management-service/api/v1/cache
ams.base-url: http://localhost:9905//api/v1/cache

###########  Cache API URLS ###################
cache.api.base-url: ${ams.base-url}/addBucket/{bucketUsername}

# Request Timeout
cache.api.timeout.request: 10         # Individual request timeout in seconds

# Retry Configuration
cache.api.retry.max-attempts: 3       # Maximum retry attempts
cache.api.retry.initial-backoff: 2    # Initial backoff in seconds
cache.api.retry.max-backoff: 10       # Maximum backoff in seconds

# Parallel Processing Configuration
cache.api.parallel.concurrency: 10    # Number of concurrent API requests